

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/bg/panda.jpg">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="Weipp">
  <meta name="keywords" content="">
  
  <title>åº”ç”¨DCTå®ç°å¯¹éŸ³é¢‘æ°´å°çš„æ·»åŠ å’Œæå– - Weipp&#39;s blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->

  
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/bynotes/texiao/source/css/gundongtiao.css# æ»šåŠ¨æ¡é¢œè‰².css">
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/bynotes/texiao/source/css/shubiao.css# é¼ æ ‡æŒ‡é’ˆ.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.11","typing":{"enable":true,"typeSpeed":100,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":"Â§"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Weipp's blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-books"></i>
                æ–‡ç« 
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/archives/">
                    <i class="iconfont icon-archive-fill"></i>
                    å½’æ¡£
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/">
                    <i class="iconfont icon-category-fill"></i>
                    åˆ†ç±»
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/tags/">
                    <i class="iconfont icon-tags-fill"></i>
                    æ ‡ç­¾
                  </a>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äºæˆ‘
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                å‹é“¾
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('https://user-images.githubusercontent.com/73998546/183948742-8ab26ae2-45a9-41cd-990a-84d0750eae4e.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="åº”ç”¨DCTå®ç°å¯¹éŸ³é¢‘æ°´å°çš„æ·»åŠ å’Œæå–">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-08-10 23:13" pubdate>
        2022å¹´8æœˆ10æ—¥ æ™šä¸Š
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      2.7k å­—
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      39
       åˆ†é’Ÿ
    </span>
  

  
  
    
      <!-- ä¸è’œå­ç»Ÿè®¡æ–‡ç« PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> æ¬¡
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">åº”ç”¨DCTå®ç°å¯¹éŸ³é¢‘æ°´å°çš„æ·»åŠ å’Œæå–</h1>
            
            <div class="markdown-body">
              <h3 id="å…³äºæ•°å­—æ°´å°"><a href="#å…³äºæ•°å­—æ°´å°" class="headerlink" title="å…³äºæ•°å­—æ°´å°"></a>å…³äºæ•°å­—æ°´å°</h3><p>æ•°å­—â½”å°æŠ€æœ¯æ˜¯â¼€ç§ä¿¡æ¯éšè—æŠ€æœ¯ã€‚æ‰€è°“â¾³é¢‘æ•°å­—â½”å°ç®—æ³•å°±æ˜¯å°†æ•°å­—â½”å°é€šè¿‡â½”å°åµŒâ¼Šç®—æ³•åµŒâ¼Šåˆ°â¾³é¢‘â½‚ä»¶ä¸­ï¼ˆå¦‚ .wavã€.mp3ã€.avi ç­‰ï¼‰ï¼Œä½†å¯¹åŸâ¾³è´¨æ²¡æœ‰å½±å“ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒåµŒå…¥å‰åçš„éŸ³é¢‘äººè€³æ— æ³•è¯†åˆ«ã€‚æ°´å°æå–çš„è¿‡ç¨‹ä¸å‰é¢æ­£ç›¸åï¼Œæˆ‘ä»¬éœ€è¦ä»åµŒå…¥æ°´å°çš„éŸ³é¢‘ä¸­å®Œæ•´çš„æå–å‡ºæ°´å°ã€‚</p>
<p>åŒæ—¶ï¼Œæ°´å°åµŒå…¥éŸ³é¢‘éœ€è¦å¯¹æ”»å‡»å’Œå…¶ä»–ç±»å‹çš„å¤±çœŸå…·æœ‰é²æ£’æ€§ï¼Œä»¥é˜²æ­¢ç¯¡æ”¹å’Œä¼ªé€ ã€‚å…¸å‹çš„æ”»å‡»åŒ…æ‹¬æ·»åŠ å™ªå£°ã€æ•°æ®å‹ç¼©ã€è¿‡æ»¤ã€é‡é‡‡æ ·ã€æ··å“ç­‰ã€‚</p>
<h3 id="DCTæ€æƒ³"><a href="#DCTæ€æƒ³" class="headerlink" title="DCTæ€æƒ³"></a>DCTæ€æƒ³</h3><p>DCTå˜æ¢çš„å…¨ç§°æ˜¯ç¦»æ•£ä½™å¼¦å˜æ¢(Discrete Cosine Transform)ï¼ŒDCTæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„DFTï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒDCTå˜æ¢å°±æ˜¯è¾“å…¥ä¿¡å·ä¸ºå®å¶å‡½æ•°çš„DFTå˜æ¢ã€‚</p>
<p>æˆ‘çš„æƒ³æ³•æ˜¯é€šè¿‡DCTå˜æ¢å°†éŸ³é¢‘ä»æ—¶åŸŸè½¬æ¢åˆ°é¢‘åŸŸï¼Œåœ¨é¢‘åŸŸä¸­å¯»æ‰¾å¼•èµ·æ•´ä½“æ”¹å˜æœ€å°çš„æ•°æ®å—ï¼Œå¹¶å°†å…¶ç”¨æˆ‘ä»¬çš„æ°´å°è¿›è¡Œè¦†ç›–ã€‚</p>
<p><img src="https://user-images.githubusercontent.com/73998546/183948742-8ab26ae2-45a9-41cd-990a-84d0750eae4e.png" srcset="/img/loading.gif" lazyload alt="DCTå˜æ¢"></p>
<p>DCTå’Œé€†DCTçš„å…¬å¼ï¼š</p>
<p><del>æ°´å¹³æœ‰é™ï¼Œåªèƒ½ä¸æ±‚ç”šè§£äº†</del>ğŸ˜­</p>
<p><img src="https://user-images.githubusercontent.com/73998546/183949971-1f784650-743d-4b79-9908-0ec9bf7fea7d.png" srcset="/img/loading.gif" lazyload alt="DCTå’Œé€†DCT"></p>
<h3 id="å¯¹éŸ³é¢‘æ·»åŠ éŸ³é¢‘æ°´å°"><a href="#å¯¹éŸ³é¢‘æ·»åŠ éŸ³é¢‘æ°´å°" class="headerlink" title="å¯¹éŸ³é¢‘æ·»åŠ éŸ³é¢‘æ°´å°"></a>å¯¹éŸ³é¢‘æ·»åŠ éŸ³é¢‘æ°´å°</h3><p>DCTæ°´å°ç®—æ³•æ€æƒ³</p>
<hr>
<p>1ï¼šå°†åŸå§‹éŸ³é¢‘ç»Ÿä¸€è½¬æ¢ä¸ºåŒå£°é“æ•°ç»„ï¼ˆmè¡Œ2åˆ—ï¼‰ï¼Œå¯¹æ•°ç»„è¿›è¡Œåˆ†å—</p>
<p>2ï¼šå‡è®¾æˆ‘ä»¬å¾—åˆ°nä¸ªè¿™æ ·çš„å—</p>
<p>3ï¼šéšæœºç”Ÿæˆkç§˜é’¥ã€‚kçš„çº¬åº¦å’Œå—çº¬åº¦ç›¸åŒ</p>
<p>4ï¼šæ°´å°çš„å¤§å°ä¸ºw*hï¼Œå› æ­¤æ°´å°ä¸­æœ‰feature=w*hä¸ªç‰¹å¾ç‚¹</p>
<p>5ï¼šå¦‚æœnâ‰¤featureï¼Œåˆ™æ— æ³•åµŒå…¥æ°´å°</p>
<p>6ï¼šå¯¹æ°´å°ä¸­çš„æ¯ä¸€ä¸ªç‰¹å¾ç‚¹ï¼Œé‡å¤7-10ï¼š</p>
<p>7ï¼šè®¡ç®—ç¬¬iä¸ªåŸå§‹éŸ³é¢‘å—çš„DCTï¼Œç§°å…¶ä¸ºdct blockã€‚</p>
<p>8ï¼šè®¡ç®—change[i] = k[i] Ã— watermark[h][w]</p>
<p>9ï¼šå°†change[i]å’Œå½“å‰dct blockçš„æœ€åä¸€åˆ—ç›¸åŠ ï¼Œdct block[i, collum âˆ’ 1]+ = change[i]</p>
<p>10ï¼šè®¡ç®—dct blockçš„é€†DCTå¹¶ä¿å­˜</p>
<p>11ï¼šå¾—åˆ°åµŒå…¥æ°´å°çš„éŸ³é¢‘</p>
<hr>
<h3 id="å…³é”®ä»£ç æ€è·¯"><a href="#å…³é”®ä»£ç æ€è·¯" class="headerlink" title="å…³é”®ä»£ç æ€è·¯"></a>å…³é”®ä»£ç æ€è·¯</h3><ul>
<li><p>åˆå§‹åŒ–å¯¹è±¡</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, background, watermark, block_size, alpha</span>):</span><br>        b_h, b_w = background.shape[:<span class="hljs-number">2</span>]<br>        w_h, w_w = watermark.shape[:<span class="hljs-number">2</span>]<br>        <span class="hljs-keyword">assert</span> w_h &lt;= b_h / block_size, \<br>            <span class="hljs-string">&quot;\r\nè¯·ç¡®ä¿æ‚¨çš„çš„æ°´å°éŸ³é¢‘å°ºå¯¸ ä¸å¤§äº åŸæœ‰éŸ³é¢‘å°ºå¯¸çš„1/&#123;:&#125;\r\nbackgroundå°ºå¯¸&#123;:&#125;\r\nwatermarkå°ºå¯¸&#123;:&#125;&quot;</span>.<span class="hljs-built_in">format</span>(<br>                block_size, background.shape, watermark.shape<br>            )<br>        <span class="hljs-comment"># å—å¤§å°ä¿å­˜</span><br>        self.block_size = block_size<br>        self.block_size_y = b_w<br>        <span class="hljs-comment"># æ°´å°å¼ºåº¦æ§åˆ¶</span><br>        self.alpha = alpha<br>        <span class="hljs-comment"># éšæœºåºåˆ—</span><br>        self.k1 = np.random.randn(block_size)<br></code></pre></div></td></tr></table></figure>

<p>è¿™é‡Œæœ‰ä¸€ä¸ªå¼ºæ¡ä»¶ï¼šæ°´å°éŸ³é¢‘æ˜¯åŸæœ‰éŸ³é¢‘å¤§å°çš„1/nã€‚å¦åˆ™æ°´å°å—å’ŒåŸæœ‰å—çš„æ˜ å°„å…³ç³»è¢«ç ´åï¼Œæ°´å°éŸ³é¢‘å°†æ— æ³•å®Œå…¨æ’å…¥åˆ°åŸæœ‰éŸ³é¢‘ä¸­ã€‚</p>
</li>
<li><p>åˆ†å—&amp;DCTå˜æ¢</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dct_blk</span>(<span class="hljs-params">self, background</span>):</span><br>        <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">        å¯¹backgroundè¿›è¡Œåˆ†å—ï¼Œç„¶åè¿›è¡Œdctå˜æ¢ï¼Œå¾—åˆ°dctå˜æ¢åçš„çŸ©é˜µ</span><br><span class="hljs-string">        &#x27;&#x27;&#x27;</span><br><br>        background_dct_blocks_h = background.shape[<span class="hljs-number">0</span>]//self.block_size<br>        background_dct_blocks = np.zeros(shape=(<br>            (background_dct_blocks_h,<br>             self.block_size, background.shape[<span class="hljs-number">1</span>])<br>        ))  <br>        <span class="hljs-comment"># å‰2ä¸ªç»´åº¦ç”¨æ¥éå†æ‰€æœ‰blockï¼Œå2ä¸ªç»´åº¦ç”¨æ¥å­˜å‚¨æ¯ä¸ªblockçš„DCTå˜æ¢çš„å€¼</span><br>        <span class="hljs-comment"># å‚ç›´æ–¹å‘åˆ†æˆbackground_dct_blocks_hä¸ªå—</span><br>        h_data = np.vsplit(background, background_dct_blocks_h)<br>        <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(background_dct_blocks_h):<br>            a_block = h_data[h]<br>            <span class="hljs-comment"># dctå˜æ¢</span><br>            background_dct_blocks[h, ...] = dct(a_block, <span class="hljs-built_in">type</span>=<span class="hljs-number">3</span>, norm=<span class="hljs-string">&quot;ortho&quot;</span>)<br>        <span class="hljs-keyword">return</span> background_dct_blocks<br></code></pre></div></td></tr></table></figure></li>
<li><p>æ°´å°åµŒå…¥</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dct_embed</span>(<span class="hljs-params">self, dct_data, watermark</span>):</span><br>        <span class="hljs-string">&quot;&quot;&quot;_summary_</span><br><span class="hljs-string">        åµŒå…¥æ°´å°åˆ°original audioçš„dctç³»æ•°ä¸­</span><br><span class="hljs-string">        Args:</span><br><span class="hljs-string">            dct_data (_type_): original audioçš„dctç³»æ•°</span><br><span class="hljs-string">            watermark (_type_): éŸ³é¢‘æ•°ç»„</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;--------dct_embed start-----------------&quot;</span>)<br>        temp = watermark.flatten()<br>        result = dct_data.copy()<br>        <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(watermark.shape[<span class="hljs-number">0</span>]):<br>            <span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(watermark.shape[<span class="hljs-number">1</span>]):   <br>                <span class="hljs-comment"># æŸ¥è¯¢å—(h,w)å¹¶éå†å¯¹åº”å—çš„æœ€åä¸€åˆ—ï¼ˆå½±å“æœ€å°çš„éƒ¨åˆ†ï¼‰ï¼Œè¿›è¡Œä¿®æ”¹</span><br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(self.block_size):<br>                    result[h, i, self.block_size_y-<span class="hljs-number">1</span>] = dct_data[h,<br>                                                                 i, self.block_size_y-<span class="hljs-number">1</span>]+self.alpha*watermark[h][w]<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;--------dct_embed end-----------------&quot;</span>)<br>        <span class="hljs-keyword">return</span> result<br></code></pre></div></td></tr></table></figure></li>
<li><p>IDCT(DCTé€†å˜æ¢)</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">idct_embed</span>(<span class="hljs-params">self, dct_data</span>):</span><br>        <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">        è¿›è¡Œå¯¹dctçŸ©é˜µè¿›è¡Œidctå˜æ¢ï¼Œå®Œæˆä»é¢‘åŸŸåˆ°ç©ºåŸŸçš„å˜æ¢</span><br><span class="hljs-string">        &#x27;&#x27;&#x27;</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;--------idct_embed start-----------------&quot;</span>)<br>        row = <span class="hljs-literal">None</span><br>        result = <span class="hljs-literal">None</span><br>        h = dct_data.shape[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(h):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;--------Round:&quot;</span>, i, <span class="hljs-string">&quot;-----------------&quot;</span>)<br>            block = idct(dct_data[i, ...], <span class="hljs-built_in">type</span>=<span class="hljs-number">3</span>, norm=<span class="hljs-string">&quot;ortho&quot;</span>)<br>            result = block <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> np.vstack((result, block))<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;--------idct_embed end-----------------&quot;</span>)<br>        <span class="hljs-keyword">return</span> result<br></code></pre></div></td></tr></table></figure></li>
<li><p>æ°´å°æå–</p>
<p>åœ¨æ¯ä¸€ä¸ªå—ä¸­ï¼Œéå†å¯¹åº”çš„åŠ å¯†åŒºåŸŸï¼ˆæ¯ä¸ªå—æœ€åä¸€åˆ—ï¼‰ï¼Œè¿›è¡ŒåŠ å¯†çš„é€†æ“ä½œï¼Œå¾—åˆ°æå–å‡ºçš„æ°´å°ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dct_extract</span>(<span class="hljs-params">self, synthesis, watermark_size, background</span>):</span><br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        ä»åµŒå…¥æ°´å°çš„éŸ³é¢‘ä¸­æå–æ°´å°</span><br><span class="hljs-string">        :param synthesis: åµŒå…¥æ°´å°çš„ç©ºåŸŸéŸ³é¢‘</span><br><span class="hljs-string">        :param watermark_size: æ°´å°å¤§å°</span><br><span class="hljs-string">        :return: æå–çš„ç©ºåŸŸæ°´å°</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        w_h, w_w = watermark_size<br>        recover_watermark = np.zeros(shape=watermark_size)<br>        synthesis_dct_blocks = self.dct_blk(background=synthesis)<br>        background_dct_blocks = self.dct_blk(background=background)<br>        p = np.zeros(self.block_size)<br>        <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(w_h):<br>            <span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(w_w):<br>                <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(self.block_size):<br>                    recover_watermark[h, w] = (<br>                        synthesis_dct_blocks[h, k, self.block_size_y-<span class="hljs-number">1</span>] - background_dct_blocks[h, k, self.block_size_y-<span class="hljs-number">1</span>])/self.alpha<br>        <span class="hljs-keyword">return</span> recover_watermark<br></code></pre></div></td></tr></table></figure></li>
<li><p>ç»˜åˆ¶é¢‘è°±å›¾åƒ</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">draw_time</span>(<span class="hljs-params">path, filename</span>):</span><br>    f = wave.<span class="hljs-built_in">open</span>(path, <span class="hljs-string">&#x27;rb&#x27;</span>)<br>    params = f.getparams()<br>    params = f.getparams()<br>    <span class="hljs-comment"># é€šé“æ•°ã€é‡‡æ ·å­—èŠ‚æ•°ã€é‡‡æ ·ç‡ã€é‡‡æ ·å¸§æ•°</span><br>    nchannels, sampwidth, framerate, nframes = params[:<span class="hljs-number">4</span>]<br>    voiceStrData = f.readframes(nframes)<br>    waveData = np.fromstring(voiceStrData, dtype=np.short)  <span class="hljs-comment"># å°†åŸå§‹å­—ç¬¦æ•°æ®è½¬æ¢ä¸ºæ•´æ•°</span><br>    <span class="hljs-comment"># éŸ³é¢‘æ•°æ®å½’ä¸€åŒ–</span><br>    waveData = waveData * <span class="hljs-number">1.0</span>/<span class="hljs-built_in">max</span>(<span class="hljs-built_in">abs</span>(waveData))<br>    <span class="hljs-comment"># å°†éŸ³é¢‘ä¿¡å·è§„æ•´ä¹˜æ¯è¡Œä¸€è·¯é€šé“ä¿¡å·çš„æ ¼å¼ï¼Œå³è¯¥çŸ©é˜µä¸€è¡Œä¸ºä¸€ä¸ªé€šé“çš„é‡‡æ ·ç‚¹ï¼Œå…±nchannelsè¡Œ</span><br>    waveData = np.reshape(waveData, [nframes, nchannels]).T  <span class="hljs-comment"># .T è¡¨ç¤ºè½¬ç½®</span><br>    f.close()<br><br>    time = np.arange(<span class="hljs-number">0</span>, nframes)*(<span class="hljs-number">1.0</span>/framerate)<br>    plt.plot(time, waveData[<span class="hljs-number">0</span>, :], c=<span class="hljs-string">&#x27;b&#x27;</span>)<br>    plt.xlabel(<span class="hljs-string">&#x27;time&#x27;</span>)<br>    plt.ylabel(<span class="hljs-string">&#x27;am&#x27;</span>)<br>    plt.savefig(<span class="hljs-string">&#x27;./%s.jpg&#x27;</span> % filename)<br>    plt.show()<br></code></pre></div></td></tr></table></figure></li>
<li><p>ä¸»å‡½æ•°</p>
<p>ä¸¤ä¸ªifï¼š</p>
<p><code>if((np.shape(data_bg)[0] % block_size) != 0)</code></p>
<p>å¦‚æœæ•°ç»„å¤§å°æ— æ³•å¹³å‡åˆ†å—ï¼Œä¹Ÿå°±æ˜¯è¯´æ•°ç»„å¤§å°ä¸æ˜¯å—çš„å¤§å°çš„æ•´æ•°å€ï¼Œç»™æ•°ç»„åé¢åŠ é€‚å½“çš„é›¶ï¼Œä½¿å…¶å˜æˆå—å¤§å°çš„æ•´æ•°å€</p>
<p><code>if(data_bg.ndim == 1)</code></p>
<p>å£°é“æœ‰å•å£°é“å’Œç«‹ä½“å£°ä¹‹åˆ†ï¼Œå•å£°é“æŒ¯å¹…æ•°æ®ä¸ºn*1çŸ©é˜µç‚¹ï¼Œç«‹ä½“å£°ä¸ºn*2çŸ©é˜µç‚¹</p>
<p>åœ¨å•å£°é“å’ŒåŒå£°é“çš„å¤„ç†ä¸Šæœ‰æ‰€ä¸åŒï¼Œè¦åŠ ç‰¹åˆ¤</p>
<p>å½“éŸ³é¢‘ä¸ºå•å£°é“æ—¶ï¼Œç›¸å½“äºå³è€³æˆ–å·¦è€³å…¶ä¸­ä¸€ä¸ªé€šé“æ˜¯é™éŸ³çš„ï¼Œå› æ­¤è¿™é‡Œåšçš„å¤„ç†æ˜¯å°†<code>n*1çŸ©é˜µç‚¹</code>-&gt;<code>n*2çŸ©é˜µç‚¹</code>,å³åœ¨æ•°ç»„åé¢åŠ ä¸€åˆ—0ï¼ˆæˆ‘çš„ç†è§£ï¼‰ã€‚è¿˜æœ‰ä¸€ç§å¤„ç†æ˜¯å°†å·¦å³è€³çš„é€šé“å˜ä¸ºä¸€æ ·çš„ï¼Œå³åœ¨æ•°ç»„åé¢åŠ ä¸€åˆ—åŸæ•°ç»„ã€‚ï¼ˆè¿™æ˜¯å¦ä¸€ç§æƒ³æ³•ï¼Œæˆ‘åªå°è¯•äº†å‰è€…ï¼‰</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>   <br>    alpha = <span class="hljs-number">0.1</span><br>    block_size = <span class="hljs-number">4</span><br>    <span class="hljs-comment"># 1.æ•°æ®è¯»å–</span><br>    samplerate_wm, data_wm = wavfile.read(<span class="hljs-string">&quot;piano_3s.wav&quot;</span>)<br>    samplerate_bg, data_bg = wavfile.read(<span class="hljs-string">&quot;buddy_19s.wav&quot;</span>)<br>    <span class="hljs-comment">#è‹¥æ— æ³•å¹³å‡åˆ†å—ï¼Œä¹Ÿå°±æ˜¯è¯´æ•°ç»„å¤§å°ä¸æ˜¯å—çš„å¤§å°çš„æ•´æ•°å€ï¼Œç»™æ•°ç»„åŠ ä¸€åˆ—0ï¼Œä½¿å…¶å˜æˆå—å¤§å°çš„æ•´æ•°å€</span><br>    <span class="hljs-keyword">if</span>((np.shape(data_bg)[<span class="hljs-number">0</span>] % block_size) != <span class="hljs-number">0</span>):<br>        data_bg = np.r_[data_bg, np.zeros(<br>            block_size-(np.shape(data_bg)[<span class="hljs-number">0</span>] % block_size))]<br>    <span class="hljs-comment">#å°†å•å£°é“éŸ³é¢‘è½¬ä¸ºåŒå£°é“ï¼Œæ–¹ä¾¿ç»Ÿä¸€å¤„ç†</span><br>    <span class="hljs-keyword">if</span>(data_bg.ndim == <span class="hljs-number">1</span>):<br>        a = np.array(np.zeros(data_bg.shape[<span class="hljs-number">0</span>])).T<br>        data_bg = np.c_[np.array([data_bg]).T, a]<br>    <span class="hljs-built_in">print</span>(np.shape(data_wm), np.shape(data_bg))<br><br>    <span class="hljs-comment"># 2.åˆ†å—&amp;dct</span><br>    dct_embed = DCT_Embed(background=data_bg, watermark=data_wm,<br>                          block_size=block_size, alpha=alpha)<br>    background_dct_blocks = dct_embed.dct_blk(background=data_bg)<br>    <span class="hljs-comment"># print(np.shape(background_dct_blocks))</span><br>    <span class="hljs-comment"># 3.åµŒå…¥æ°´å°åˆ°é¢‘åŸŸ</span><br>    embed_wm_blocks = dct_embed.dct_embed(<br>        dct_data=background_dct_blocks, watermark=data_wm)<br>    <span class="hljs-comment"># 4.idct ä»é¢‘åŸŸå˜æ¢åˆ°æ—¶åŸŸ</span><br>    synthesis = dct_embed.idct_embed(dct_data=embed_wm_blocks)<br>    data = normalizeForWav(synthesis)<br>    wavfile.write(<span class="hljs-string">&quot;piano_dct.wav&quot;</span>, samplerate_bg, data)<br>    draw_time(<span class="hljs-string">&quot;piano_3s.wav&quot;</span>,<span class="hljs-string">&quot;piano_3s&quot;</span>)<br>    draw_time(<span class="hljs-string">&quot;buddy_19s.wav&quot;</span>,<span class="hljs-string">&quot;buddy_19s&quot;</span>)<br>    draw_time(<span class="hljs-string">&quot;piano_dct.wav&quot;</span>,<span class="hljs-string">&quot;piano_dct&quot;</span>)<br><br>    <span class="hljs-comment"># 5.æå–æ°´å°</span><br>    samplerate_syn, data_syn = wavfile.read(<span class="hljs-string">&quot;bunny_compress.wav&quot;</span>)<br>    <span class="hljs-keyword">if</span>((np.shape(data_syn)[<span class="hljs-number">0</span>] % block_size) != <span class="hljs-number">0</span>):<br>        data_syn = np.r_[data_syn, np.zeros(<br>            block_size-(np.shape(data_syn)[<span class="hljs-number">0</span>] % block_size))]<br>    <span class="hljs-keyword">if</span>(data_syn.ndim == <span class="hljs-number">1</span>):<br>        a = np.array(np.zeros(data_syn.shape[<span class="hljs-number">0</span>])).T<br>        data_syn = np.c_[np.array([data_syn]).T, a]<br>    <span class="hljs-built_in">print</span>(np.shape(data_syn))<br>    extract_watermark = dct_embed.dct_extract(<br>        synthesis=data_syn, watermark_size=data_wm.shape, background=data_bg)<br>    data = normalizeForWav(extract_watermark)<br>    wavfile.write(<span class="hljs-string">&quot;compress_ext.wav&quot;</span>, samplerate_wm, data)<br>    draw_time(<span class="hljs-string">&quot;piano_3s.wav&quot;</span>, <span class="hljs-string">&quot;piano_3s&quot;</span>)<br>    draw_time(<span class="hljs-string">&quot;compress_ext.wav&quot;</span>, <span class="hljs-string">&quot;compress_ext&quot;</span>)<br>    <br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">normalizeForWav</span>(<span class="hljs-params">data</span>):</span><br>    <span class="hljs-keyword">return</span> np.int16(data.real)<br></code></pre></div></td></tr></table></figure></li>
</ul>
<h3 id="ç»“æœå±•ç¤º"><a href="#ç»“æœå±•ç¤º" class="headerlink" title="ç»“æœå±•ç¤º"></a>ç»“æœå±•ç¤º</h3><p>æ˜¯æ—¶å€™å±•ç¤ºçœŸæ­£çš„å®åŠ›äº†ï¼</p>
<ul>
<li>åŸå§‹éŸ³é¢‘</li>
</ul>
<audio id="audio" controls="" preload="none">
      <source id="mp3" src="/img/audio/buddy_19s.mp3">
</audio>

<p><img src="https://user-images.githubusercontent.com/73998546/184077279-c343a937-b749-42d8-8d64-f43358169f44.png" srcset="/img/loading.gif" lazyload alt="åŸå§‹éŸ³é¢‘é¢‘è°±"></p>
<ul>
<li>æ°´å°éŸ³é¢‘</li>
</ul>
<audio id="audio" controls="" preload="none">
      <source id="mp3" src="/img/audio/piano_3s.mp3">
</audio>

<p><img src="https://user-images.githubusercontent.com/73998546/184077537-2ca091f7-b7d2-4e9e-8d30-ad1661d61375.jpg" srcset="/img/loading.gif" lazyload alt="æ°´å°éŸ³é¢‘é¢‘è°±"></p>
<ul>
<li>åµŒå…¥æ°´å°çš„éŸ³é¢‘</li>
</ul>
<audio id="audio" controls="" preload="none">
      <source id="mp3" src="/img/audio/piano_dct.mp3">
</audio>

<p><img src="https://user-images.githubusercontent.com/73998546/184077542-b48290ae-c1b1-4420-bcfb-fa8c0d8f3794.jpg" srcset="/img/loading.gif" lazyload alt="åµŒå…¥æ°´å°çš„éŸ³é¢‘é¢‘è°±"></p>
<ul>
<li>æå–å‡ºçš„æ°´å°éŸ³é¢‘</li>
</ul>
<audio id="audio" controls="" preload="none">
      <source id="mp3" src="/img/audio/piano_ext.mp3">
</audio>

<p><img src="https://user-images.githubusercontent.com/73998546/184077559-6f4013fa-3b32-4cf4-94c3-caccb8deef6e.jpg" srcset="/img/loading.gif" lazyload alt="æå–å‡ºçš„æ°´å°éŸ³é¢‘é¢‘è°±"></p>
<h3 id="ç»“æœåˆ†æ"><a href="#ç»“æœåˆ†æ" class="headerlink" title="ç»“æœåˆ†æ"></a>ç»“æœåˆ†æ</h3><p>ç»è¿‡å›¾åƒæ¯”å¯¹å’Œç›¸å…³æ€§åˆ†æï¼Œå¯ä»¥çœ‹å‡ºæå–å‡ºçš„æ°´å°å’ŒåŸæ°´å°è¿˜æ˜¯æœ‰ä¸€äº›å·®åˆ«çš„ã€‚ä¸»è¦åŸå› æ˜¯å°†.wavæ ¼å¼çš„éŸ³é¢‘è½¬ä¸ºæ•°ç»„çš„æ—¶å€™ï¼Œæ˜¯intå‹æ•°ç»„ã€‚è€Œåœ¨åšDCTï¼ŒIDCTå˜æ¢åï¼Œæ•°ç»„å˜ä¸ºfloatå‹ã€‚æœ€åä¸ºäº†ç¬¦åˆ.wavæ ¼å¼ï¼Œéœ€è¦æŠŠfloatå‹å¼ºåˆ¶è½¬æ¢ä¸ºintå‹ï¼Œè¿™å¯¼è‡´éƒ¨åˆ†ç²¾åº¦ä¸¢å¤±ã€‚ğŸ˜­</p>
<h3 id="å¯¹éŸ³é¢‘æ·»åŠ å›¾åƒæ°´å°"><a href="#å¯¹éŸ³é¢‘æ·»åŠ å›¾åƒæ°´å°" class="headerlink" title="å¯¹éŸ³é¢‘æ·»åŠ å›¾åƒæ°´å°"></a>å¯¹éŸ³é¢‘æ·»åŠ å›¾åƒæ°´å°</h3><p>è·Ÿå‰é¢çš„DCTç®—æ³•æ€æƒ³ç±»ä¼¼ï¼Œä¸åŒçš„å°±æ˜¯å°†å›¾ç‰‡ä½œä¸ºæ°´å°æ’å…¥åˆ°éŸ³é¢‘ä¸­ã€‚ä¸éŸ³é¢‘æ°´å°è½¬æ¢ä¸ºçš„æ•°ç»„ï¼ˆm*2ï¼‰ä¸åŒï¼Œå›¾ç‰‡æ°´å°è½¬æ¢ä¸ºçš„æ•°ç»„æ›´å¤§ï¼ˆm*nï¼‰ã€‚å›¾ç‰‡çš„åƒç´ ç‚¹å¯ä»¥è¿›è¡ŒäºŒå€¼å½’ä¸€åŒ–ï¼Œ1è¡¨ç¤ºé»‘è‰²åƒç´ ï¼Œ0è¡¨ç¤ºç™½è‰²åƒç´ ã€‚</p>
<ul>
<li><p>åˆ†å—&amp;DCTå˜æ¢&amp;æ°´å°åµŒå…¥</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dct_embed</span>(<span class="hljs-params">audio0,leng,img</span>):</span><br>    numFrames = math.ceil(audio0.shape[<span class="hljs-number">0</span>] / leng)<br>    frames = <span class="hljs-built_in">list</span>()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(numFrames):<br>        frames.append(audio0[i * leng: (i * leng) + leng])<br>    ary_frames=np.asarray(frames)<br>    DCTCoeffs = np.copy(ary_frames)<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ary_frames.shape[<span class="hljs-number">0</span>]):<br>        DCTCoeffs[i] = DCT(ary_frames[i])<br><br>    width, height = img.size<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(DCTCoeffs)):<br>        <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span>:<br>            audio = DCTCoeffs[i]<br>        <span class="hljs-keyword">else</span>:<br>            audio = np.concatenate((audio, DCTCoeffs[i]), axis=<span class="hljs-number">0</span>)<br>    embedded = audio.copy()<br>    <span class="hljs-comment"># Embedding width and heigth</span><br>    embedded[<span class="hljs-number">0</span>][-<span class="hljs-number">1</span>] = width<br>    embedded[<span class="hljs-number">1</span>][-<span class="hljs-number">1</span>] = height<br>    <span class="hljs-comment"># Embedding watermark</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(width):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(height):<br>            value = img.getpixel(xy=(i, j))<br>            value = <span class="hljs-number">1</span> <span class="hljs-keyword">if</span> value == <span class="hljs-number">255</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span><br>            x = i * height + j<br>            embedded[x + <span class="hljs-number">32</span>][<span class="hljs-number">0</span>] = setLastBit(embedded[x + <span class="hljs-number">32</span>][<span class="hljs-number">0</span>], value)<br>            <br>    <span class="hljs-keyword">return</span> embedded<br></code></pre></div></td></tr></table></figure></li>
<li><p>IDCTå˜æ¢</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">idct_embed</span>(<span class="hljs-params">audio,leng</span>):</span><br>    numFrames = math.ceil(audio.shape[<span class="hljs-number">0</span>] / leng)<br>    frames = <span class="hljs-built_in">list</span>()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(numFrames):<br>        frames.append(audio[i * leng: (i * leng) + leng])<br>    ary_frames = np.asarray(frames)<br>    iDCTCoeffs = np.copy(ary_frames)<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ary_frames.shape[<span class="hljs-number">0</span>]):<br>        iDCTCoeffs[i] = iDCT(ary_frames[i])<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(iDCTCoeffs)):<br>        <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span>:<br>            synthesis = iDCTCoeffs[i]<br>        <span class="hljs-keyword">else</span>:<br>            synthesis = np.concatenate((synthesis, iDCTCoeffs[i]), axis=<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">return</span> synthesis<br></code></pre></div></td></tr></table></figure></li>
<li><p>æ°´å°æå–</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dct_extract</span>(<span class="hljs-params">audio,leng</span>):</span><br>    numFrames = math.ceil(audio.shape[<span class="hljs-number">0</span>] / leng)<br>    frames = <span class="hljs-built_in">list</span>()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(numFrames):<br>        frames.append(audio[i * leng: (i * leng) + leng])<br>    ary_frames = np.asarray(frames)<br>    DCTCoeffs = np.copy(ary_frames)<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ary_frames.shape[<span class="hljs-number">0</span>]):<br>        DCTCoeffs[i] = DCT(ary_frames[i])<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(DCTCoeffs)):<br>        <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span>:<br>            audio = DCTCoeffs[i]<br>        <span class="hljs-keyword">else</span>:<br>            audio = np.concatenate((audio, DCTCoeffs[i]), axis=<span class="hljs-number">0</span>)<br><br>    width, heigth = (<span class="hljs-number">112</span>, <span class="hljs-number">112</span>)  <span class="hljs-comment"># sizeExtraction(joinAudio)</span><br>    image = Image.new(<span class="hljs-string">&quot;1&quot;</span>, (width, heigth))<br>    <span class="hljs-comment"># Embedding watermark</span><br>    <span class="hljs-comment"># Extraction watermark</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(width):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(heigth):<br>            x = i * heigth + j<br>            value = getLastBit(audio[x + <span class="hljs-number">32</span>][<span class="hljs-number">0</span>])<br>            image.putpixel(xy=(i, j), value=value)<br><br>    <span class="hljs-keyword">return</span> image<br></code></pre></div></td></tr></table></figure></li>
<li><p>ä¸»å‡½æ•°</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    root = <span class="hljs-string">&quot;..&quot;</span><br><br>    <span class="hljs-comment"># 0. è¶…å‚æ•°è®¾ç½®</span><br><br>    length_frame = <span class="hljs-number">4</span> <span class="hljs-comment"># æ¯æ®µé•¿åº¦</span><br><br>    <span class="hljs-comment"># 1. æ•°æ®è¯»å–</span><br><br>    <span class="hljs-comment"># watermak</span><br>    img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;lock.png&quot;</span>)<br>    img = img.convert(mode=<span class="hljs-string">&quot;1&quot;</span>,dither=<span class="hljs-number">0</span>)<br>    samplerate, data = wavfile.read(<span class="hljs-string">&quot;test.wav&quot;</span>)<br>    <span class="hljs-comment"># print(data)</span><br>    <span class="hljs-comment"># print((np.asarray(data)).shape)</span><br><br>    <span class="hljs-comment"># 2. åµŒå…¥æ°´å°å›¾åƒ</span><br>    embed_watermak_audio = dct_embed(audio0=data,leng=length_frame,img=img)  <span class="hljs-comment"># åœ¨dctå—ä¸­åµŒå…¥æ°´å°å›¾åƒ</span><br><br>    <span class="hljs-comment"># 3. å°†å›¾åƒè½¬æ¢ä¸ºç©ºåŸŸå½¢å¼</span><br>    synthesis = idct_embed(audio=embed_watermak_audio,leng=length_frame)  <span class="hljs-comment"># idctå˜æ¢å¾—åˆ°ç©ºåŸŸå›¾åƒ</span><br>    <span class="hljs-comment"># print(synthesis)</span><br>    <span class="hljs-comment"># print((np.asarray(synthesis)).shape)</span><br>    wavfile.write(<span class="hljs-string">&quot;Output.wav&quot;</span>, samplerate, synthesis)<br>    <span class="hljs-comment"># 4. æå–æ°´å°</span><br>    extract_watermark = dct_extract(audio=synthesis, leng=length_frame)<br>    extract_watermark = extract_watermark.convert(<span class="hljs-string">&#x27;RGBA&#x27;</span>)<br>    <span class="hljs-comment"># extract_watermark.show()</span><br><br>    images = [img, extract_watermark]<br>    titles = [<span class="hljs-string">&quot;Watermark&quot;</span>, <span class="hljs-string">&quot;Extract_Watermark&quot;</span>]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>        plt.subplot(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, i + <span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">if</span> i % <span class="hljs-number">2</span>:<br>            plt.imshow(images[i], cmap=plt.cm.gray)<br>        <span class="hljs-keyword">else</span>:<br>            plt.imshow(images[i])<br>        plt.title(titles[i])<br>        plt.axis(<span class="hljs-string">&quot;off&quot;</span>)<br>    plt.show()<br><br>    show_wav(<span class="hljs-string">&quot;test.wav&quot;</span>)<br>    show_wav(<span class="hljs-string">&quot;Output.wav&quot;</span>)<br></code></pre></div></td></tr></table></figure></li>
</ul>
<h3 id="ç»“æœå±•ç¤º-1"><a href="#ç»“æœå±•ç¤º-1" class="headerlink" title="ç»“æœå±•ç¤º"></a>ç»“æœå±•ç¤º</h3><ul>
<li>åŸå§‹éŸ³é¢‘</li>
</ul>
<audio id="audio" controls="" preload="none">
      <source id="mp3" src="/img/audio/buddy_19s.mp3">
</audio>

<p><img src="https://user-images.githubusercontent.com/73998546/184400801-7e5838e1-b394-44fa-ae83-05d6940dc6ae.png" srcset="/img/loading.gif" lazyload alt="åŸå§‹éŸ³é¢‘é¢‘è°±"></p>
<ul>
<li>åµŒå…¥æ°´å°çš„éŸ³é¢‘</li>
</ul>
<audio id="audio" controls="" preload="none">
      <source id="mp3" src="/img/audio/Output.mp3">
</audio>

<p><img src="https://user-images.githubusercontent.com/73998546/184400834-1ba5c222-3cc1-4435-9bbb-cbdfbb753377.png" srcset="/img/loading.gif" lazyload alt="åµŒå…¥æ°´å°çš„éŸ³é¢‘é¢‘è°±"></p>
<ul>
<li>æ°´å°ï¼ˆè‚‰çœ¼çœ‹ç¡®å®å·®ç‚¹æ„æ€ï¼‰</li>
</ul>
<p><img src="https://user-images.githubusercontent.com/73998546/184400847-dbae0a01-ad3b-4018-9d27-129fb3705aa7.png" srcset="/img/loading.gif" lazyload alt="æ°´å°"></p>
<h3 id="ç»“æœåˆ†æ-1"><a href="#ç»“æœåˆ†æ-1" class="headerlink" title="ç»“æœåˆ†æ"></a>ç»“æœåˆ†æ</h3><p>åŒä¸Šï¼ŒDCT,IDCTå‰åè½¬æ¢æ•°æ®ç²¾åº¦ä¸¢å¤±çš„é—®é¢˜ã€‚</p>
<p>å°±è¿™æ ·å§</p>
<p>å…·ä½“ä»£ç å®ç°åœ¨è¿™é‡Œ<br><a target="_blank" rel="noopener" href="https://github.com/Weipp7/NUS-Project-Audio-Watermarking">DCT-AUDIO</a><br><a target="_blank" rel="noopener" href="https://github.com/Eipi15926/Audio-Steganography-and-Watermark/tree/DCT-Image">DCT-IMAGE</a></p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/DCT/">DCT</a>
                    
                      <a class="hover-with-bg" href="/tags/Audio-Watermark/">Audio Watermark</a>
                    
                  </div>
                
              </div>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/posts/fe644ae0.html">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">åˆ·é¢˜è®°å½•</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/posts/1f6f5090.html">
                        <span class="hidden-mobile">NUSæš‘æ ¡å®éªŒè®°å½•</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                
  <div id="gitalk-container"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#gitalk-container', function() {
      Fluid.utils.createCssLink('/css/gitalk.css')
      Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js', function() {
        var options = Object.assign(
          {"clientID":"83dd2a243bcbd843a05a","clientSecret":"a302ebbd1e331a879fae28f46397391604cfcf4e","repo":"gitalk","owner":"Weipp7","admin":["Weipp7"],"language":"zh-CN","labels":["Gitalk"],"perPage":10,"pagerDirection":"last","distractionFreeMode":false,"createIssueManually":false,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","id":"location.href","title":"document.title"},
          {
            id: 'f6930c7c4b3e96a94eca67dc1fb10ed4'
          }
        )
        var gitalk = new Gitalk(options);
        gitalk.render('gitalk-container');
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <div class="copyright">Â©2021 By Weipp</div> <p id="run_time"></p> <script type="text/javascript" src="js/time.js"></script>
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- ä¸è’œå­ç»Ÿè®¡PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            æ€»è®¿é—®é‡ 
            <span id="busuanzi_value_site_pv"></span>
             æ¬¡
          </span>
      
      
        <!-- ä¸è’œå­ç»Ÿè®¡UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            æ€»è®¿å®¢æ•° 
            <span id="busuanzi_value_site_uv"></span>
             äºº
          </span>
      
    
  </div>


  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js" ></script>



  <script  src="/js/local-search.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>














  
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/jingtaisidai.js"></script>
<script src="//cdn.jsdelivr.net/gh/kaygb/JS-effects/fireworks.js"></script>



<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ ä¿æŒåœ¨æœ€åº•éƒ¨ -->
<script  src="/js/boot.js" ></script>


</body>
</html>
